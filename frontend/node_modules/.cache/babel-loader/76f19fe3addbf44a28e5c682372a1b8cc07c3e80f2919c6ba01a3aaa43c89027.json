{"ast":null,"code":"var _jsxFileName = \"E:\\\\Employee Timesheet chatbot\\\\frontend\\\\src\\\\components\\\\ChatPage\\\\ChatPage.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useRef } from 'react';\nimport './ChatPage.css';\nimport ChatInput from '../ChatInput/ChatInput';\nimport UploadButton from '../UploadButton/UploadButton';\nimport ChatMessage from '../ChatMessage/ChatMessage';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst ChatPage = ({\n  user,\n  sessionToken,\n  onSignOut\n}) => {\n  _s();\n  const [messages, setMessages] = useState([]);\n  const [input, setInput] = useState('');\n  const [isLoading, setIsLoading] = useState(false);\n  const [uploadStatus, setUploadStatus] = useState('');\n  const messagesEndRef = useRef(null);\n  const scrollToBottom = () => {\n    var _messagesEndRef$curre;\n    (_messagesEndRef$curre = messagesEndRef.current) === null || _messagesEndRef$curre === void 0 ? void 0 : _messagesEndRef$curre.scrollIntoView({\n      behavior: \"smooth\"\n    });\n  };\n\n  // Fetch Chat History Interval (The `map` error fix is here: Array.isArray(data.history) ? data.history : [])\n  useEffect(() => {\n    const fetchChatHistory = async () => {\n      // ... (Fetch logic remains the same)\n      try {\n        const response = await fetch(`http://127.0.0.1:5000/chat_history?session_token=${sessionToken}`);\n        if (!response.ok) {\n          console.error('Failed to fetch chat history. Status:', response.status);\n          return;\n        }\n        const data = await response.json();\n        setMessages(Array.isArray(data.history) ? data.history : []);\n      } catch (err) {\n        console.error(\"Failed to fetch chat history:\", err);\n      }\n    };\n    fetchChatHistory();\n    const intervalId = setInterval(fetchChatHistory, 3000);\n    return () => clearInterval(intervalId);\n  }, [sessionToken]);\n  useEffect(() => {\n    scrollToBottom();\n  }, [messages]);\n  const handleFileUpload = async file => {\n    // ... (File upload logic remains the same)\n  };\n  const handleSendMessage = async e => {\n    e.preventDefault();\n    // ... (Send message logic remains the same)\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"chat-container\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"chat-card\",\n      children: [/*#__PURE__*/_jsxDEV(\"header\", {\n        className: \"chat-header\",\n        children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n          className: \"text-xl font-bold\",\n          children: \"Timesheet Bot \\uD83E\\uDD16\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex items-center space-x-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-sm text-gray-400\",\n            children: [\"Welcome, \", user, \"!\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 60,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: onSignOut,\n            className: \"sign-out-button\",\n            children: \"Sign Out\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 61,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 57,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"chat-content-area\",\n        children: [uploadStatus && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `p-2 my-2 text-sm text-center rounded-lg ${uploadStatus.startsWith('Error') ? 'bg-red-500' : 'bg-green-500'}`,\n          children: uploadStatus\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chat-messages\",\n          children: [Array.isArray(messages) && messages.map((msg, index) => /*#__PURE__*/_jsxDEV(ChatMessage, {\n            sender: msg.sender,\n            text: msg.text\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 29\n          }, this)), /*#__PURE__*/_jsxDEV(\"div\", {\n            ref: messagesEndRef\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 89,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"p-4 border-t border-gray-700 flex items-center space-x-3 bg-gray-800\",\n        children: [/*#__PURE__*/_jsxDEV(UploadButton, {\n          onFileUpload: handleFileUpload\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(ChatInput, {\n          onChatSubmit: handleSendMessage,\n          isLoading: isLoading,\n          input: input,\n          setInput: setInput\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 93,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 56,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 9\n  }, this);\n};\n_s(ChatPage, \"wstlzQjEvwQwehZ244RSP/uflZo=\");\n_c = ChatPage;\nexport default ChatPage;\nvar _c;\n$RefreshReg$(_c, \"ChatPage\");","map":{"version":3,"names":["React","useState","useEffect","useRef","ChatInput","UploadButton","ChatMessage","jsxDEV","_jsxDEV","ChatPage","user","sessionToken","onSignOut","_s","messages","setMessages","input","setInput","isLoading","setIsLoading","uploadStatus","setUploadStatus","messagesEndRef","scrollToBottom","_messagesEndRef$curre","current","scrollIntoView","behavior","fetchChatHistory","response","fetch","ok","console","error","status","data","json","Array","isArray","history","err","intervalId","setInterval","clearInterval","handleFileUpload","file","handleSendMessage","e","preventDefault","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","startsWith","map","msg","index","sender","text","ref","onFileUpload","onChatSubmit","_c","$RefreshReg$"],"sources":["E:/Employee Timesheet chatbot/frontend/src/components/ChatPage/ChatPage.jsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport './ChatPage.css';\r\nimport ChatInput from '../ChatInput/ChatInput'; \r\nimport UploadButton from '../UploadButton/UploadButton'; \r\nimport ChatMessage from '../ChatMessage/ChatMessage'; \r\n\r\nconst ChatPage = ({ user, sessionToken, onSignOut }) => {\r\n    const [messages, setMessages] = useState([]);\r\n    const [input, setInput] = useState('');\r\n    const [isLoading, setIsLoading] = useState(false);\r\n    const [uploadStatus, setUploadStatus] = useState('');\r\n    const messagesEndRef = useRef(null);\r\n\r\n    const scrollToBottom = () => {\r\n        messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\r\n    };\r\n    \r\n    // Fetch Chat History Interval (The `map` error fix is here: Array.isArray(data.history) ? data.history : [])\r\n    useEffect(() => {\r\n        const fetchChatHistory = async () => {\r\n            // ... (Fetch logic remains the same)\r\n            try {\r\n                const response = await fetch(`http://127.0.0.1:5000/chat_history?session_token=${sessionToken}`);\r\n                if (!response.ok) {\r\n                    console.error('Failed to fetch chat history. Status:', response.status);\r\n                    return;\r\n                }\r\n                const data = await response.json();\r\n                setMessages(Array.isArray(data.history) ? data.history : []);\r\n            } catch (err) {\r\n                console.error(\"Failed to fetch chat history:\", err);\r\n            }\r\n        };\r\n\r\n        fetchChatHistory();\r\n        const intervalId = setInterval(fetchChatHistory, 3000);\r\n        return () => clearInterval(intervalId);\r\n    }, [sessionToken]);\r\n\r\n    useEffect(() => {\r\n        scrollToBottom();\r\n    }, [messages]);\r\n\r\n\r\n    const handleFileUpload = async (file) => {\r\n        // ... (File upload logic remains the same)\r\n    };\r\n\r\n    const handleSendMessage = async (e) => {\r\n        e.preventDefault();\r\n        // ... (Send message logic remains the same)\r\n    };\r\n\r\n    return (\r\n        <div className=\"chat-container\">\r\n            <div className=\"chat-card\">\r\n                <header className=\"chat-header\">\r\n                    <h1 className=\"text-xl font-bold\">Timesheet Bot ðŸ¤–</h1>\r\n                    <div className=\"flex items-center space-x-4\">\r\n                        <span className=\"text-sm text-gray-400\">Welcome, {user}!</span>\r\n                        <button onClick={onSignOut} className=\"sign-out-button\">\r\n                            Sign Out\r\n                        </button>\r\n                    </div>\r\n                </header>\r\n                \r\n                {/* CRITICAL LAYOUT SECTION:\r\n                  This div must be the main flexible container between the header and the input.\r\n                  The class `chat-content-area` is introduced here for specific styling. \r\n                */}\r\n                <div className=\"chat-content-area\">\r\n                    \r\n                    {uploadStatus && (\r\n                        <div className={`p-2 my-2 text-sm text-center rounded-lg ${uploadStatus.startsWith('Error') ? 'bg-red-500' : 'bg-green-500'}`}>\r\n                            {uploadStatus}\r\n                        </div>\r\n                    )}\r\n                    \r\n                    {/* The messages container must be scrollable */}\r\n                    <div className=\"chat-messages\">\r\n                        {/* FIX: Safely map over the array */}\r\n                        {Array.isArray(messages) && messages.map((msg, index) => (\r\n                            <ChatMessage \r\n                                key={index} \r\n                                sender={msg.sender} \r\n                                text={msg.text} \r\n                            />\r\n                        ))}\r\n                        <div ref={messagesEndRef} />\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"p-4 border-t border-gray-700 flex items-center space-x-3 bg-gray-800\">\r\n                    <UploadButton onFileUpload={handleFileUpload} />\r\n                    <ChatInput onChatSubmit={handleSendMessage} isLoading={isLoading} input={input} setInput={setInput} />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ChatPage;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}